# コード設計について

## コンポーネント分割

コンポーネントは、単一コンポーネントの中に複数の異なる機能が存在し、それぞれがコンポーネント内の一部でしか使用されていない場合に積極的に分割を行う。また、コンポーネント内で一つの機能を実装するのに必要なロジックが肥大化した場合も積極的に分割を行う。

再利用やテスト目的を除いて、基本的にはUIだけのコンポーネントの分割は行わず、何らかの問題が発生したときに分割する。また、UIだけのコンポーネントを分割する際に、一つのファイルでしか使用されていないときは同じファイルに配置しても良い。

コンポーネントの分割は名前をつける難しさがあるというのと、UIのためにコンポーネントを分割してしまうと一つのコンポーネントの見た目を調べるために複数のファイルをたどる必要があり手間になってしまうのではないかと感じるため、できるだけ分割は行いたくない。

## スタイリング

HTMLとCSSは同時に読むことが多かったり、同時に変更しなければいけないことが多いと感じるため、できるだけHTMLと近い場所にスタイル情報を記述したい。
そのため、`pandacss`を使用してインラインでスタイリングを行う。

`CSS Modules`も試してみたが、全てに名前をつけるのが難しいということと、要素とスタイルの対応を調べるのが手間だと感じた。最初から決まったデザインを実装する際には向いているかもしれないが、試行錯誤しながらデザインを決めていくというフローには合わないのではないかと思う。

インラインでの`pandacss`は1つのプロパティで1行を占めるためスタイルを読む際にはわかりやすいが、スタイルを読み飛ばしてコンポーネントの別のpropsや値を確認する際には見通しが悪くなってしまうという、`tailwindcss`とは逆の特徴を持っているように見える。(個人的には横に伸びるほうが全体像がわかりやすいため、`tailwindcss`が使えるのならばそちらを選びたい・・・)

## バリデーション・型付け

Next.jsのDynamic RoutesのParamsやURLSearchParams、APIレスポンスなど、外部と通信する際のデータはできるだけ`zod`を使用したバリデーションを行い、想定していない型のデータが入ってきたときにできるだけ早い段階でエラーになるようにする。

他のページやRoute HandlerのURLの取得は文字列で指定せずに、`/src/routes`以下に定義しているオブジェクトを使用する。このオブジェクトは、例えばDynamic Routesであれば事前に定義したParamsのスキーマから作った型の値を受け取り、URLを返す関数になる。複雑なバリデーションを行っている場合は、この関数でバリデーションを行っても良いかもしれない。
